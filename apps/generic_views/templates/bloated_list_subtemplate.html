{% load i18n %}
{% load generic_views_helpers %}
{% load pagination_tags %}
{% load navigation %}
{% load carts %}

{% if side_bar %}
    <div class="block">
    <h3>
        {{ title }}
    </h3>
    <div class="content">
        <p>
{% else %}
    {% autopaginate object_list %} 
    <div class="content">
    <h2 class="title">
        {% ifnotequal page_obj.paginator.num_pages 1 %}
            {% blocktrans with page_obj.start_index as start and page_obj.end_index as end and page_obj.paginator.count as total %}List of {{ title }} ({{ start }} - {{ end }} out of {{ total }}){% endblocktrans %}
        {% else %}
            {% blocktrans with page_obj.paginator.count as total %}List of {{ title }} ({{ total }}){% endblocktrans %}
        {% endifnotequal %}
    </h2>

<div class="inner">
{% endif %}

  <form action="#" class="form">
    <table class="table">
      {% if not hide_header %}
	<thead>
          <tr>
	    {% for col in columns %}
	    <th>{% if column.sortable %}<a href="{{ header.url }}">{% endif %}
		{{ col.name|capfirst }}
		{% if header.sortable %}</a>{% endif %}
		{% if column.subrows %}{% for row in column.subrows %}<br/>
			{{ row.name|capfirst }}
		{% endfor %}{%endif %}
	    </th>
	    {% endfor %}
            {% if not hide_links %}<th class="">&nbsp;</th>{% endif %}
            {% if request.session.carts %}<th class="">&nbsp;</th>{% endif %}
          </tr>
	</thead>
      {% endif %}

    <tbody>
        {% for object in object_list %}
            <tr class="{% cycle 'odd' 'even2' %}">
	    {% for col in columns %}
		{% if not col.attribute %}
		    {% if main_object %}
		    {% with object|object_property:main_object as object %}
			<td>{% if not hide_link %}<a href="{{ object.get_absolute_url }}">{{ object }}</a>{% else %}{{ object }}{% endif %}</td>
		    {% endwith %}
		    {% else %}
			<td>{% if not hide_link %}<a href="{{ object.get_absolute_url }}">{{ object }}</a>{% else %}{{ object }}{% endif %}</td>
		    {% endif %}
                {% else %}
                    <td>{{ object|object_property:col.attribute|safe }}</td>
                {% endif %}
            {% endfor %}
	    {% if not hide_links %}
		<td class='last'>
		{% object_navigation_template %}
		</td>
	    {% endif %}
            {% object_carts object %}
            </tr>
        {% empty %}
            <tr><td colspan=99 class="tc">{% blocktrans %}There are no {{ title }}{% endblocktrans %}</td></tr>
        {% endfor %}
        </tbody>
    </table>
         {% object_list_carts object_list %}
  </form>
    {% paginate %}
</div>
</div>

    {% for subform in subforms_dict %}
    {% with subform.title as title %}
    {% with subform.extra_columns as extra_columns %}
    {% with subform.form as form %}
        {% include subform.name %}
    {% endwith %}
    {% endwith %}
    {% endwith %}
    {% endfor %}

